# E-commerce 토이프로젝트

이전 Coupon 프로젝트에서 진행했던 쿠폰 발급 과정을 고도화, 새로운 기능을 추가해 간단한 이커머스 기능 구현

- Github Actions을 이용한 테스트 자동화
- Redisson을 이용한 분산 락 → Lua 스크립트를 통한 원자성 처리로 동시성 성능 개선 (RPS 10배 개선)
- JMeter 성능 테스트를 통한 Kafka 사용 전후 비교 (TPS 236% 개선,  Latency 7sec → 13ms) 

<br>

## 전체 프로젝트 구조

상품 조회 - 상품 구매(쿠폰 사용) - 광고의 구매 결정력 데이터 수집

광고 생성 - 광고 클릭

쿠폰 생성 - 쿠폰 발급


<br>

**구현 기능**
- 검색 키워드에 따라서 상품의 최저가 리스트를 조회
- 동시성을 고려한 쿠폰 발급과 사용
- 발급된 쿠폰을 사용하여 상품을 구매한 경우, 로그 데이터 수집
- 광고 시청을 통하여 상품 구매로 이어진 경우, 로그 데이터 수집
  - 단, 유의미한 구매 전환율 데이터 수집을 위하여 프로세싱 (100만원 이하, 광고 시청 시간 10초 이상)

<br> 
<br> 

### 쿠폰 발급간의 동시성 개선
1. Redis의 싱글 쓰레드를 활용하여 스핀 락 형태의 분산 락 구현
2. Redisson을 이용한 분산 락 구현(내부적으로 pubsub 이용)
3. RPS 저하 등의 성능 차이를 발견, Lua 스크립트로 전달하여 원자성 유지(EVAL)

<br> 

### 광고 전환(Ad conversion)을 위한 데이터 수집
1. 실제 구매와 광고 클릭 행위(Promotion Behavior)에 대한 각 Topic에 메시지를 발행
2. Kafka Stream을 통해 Join, Filtering을 통해 각 광고별로 구분하여 처리


광고 시청 이후 구매로 이어지는 유의미한 지표를 프로세싱
- 전환율(Conversion Rate, CVR)
- ROAS(Return on Ad Spend, 광고 비용 대비 매출)


<br>
